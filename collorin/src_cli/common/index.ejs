<!DOCTYPE html>
<html>
	<head>
		<meta http-equiv='Content-Type' content="text/html; charset=UTF-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1">
		<style type="text/css">body{margin: 0;}</style>
		<title><%=title %></title>
		<script type="text/javascript">
			window.onload = function(){
				// ローディング表記
				var action = 0;
				var loadingFunc = function(){
					var div = document.getElementById("loadingStr");
					if(div){
						switch(action++ % 4){
							case 0: div.innerHTML = "loading"; break;
							case 1: div.innerHTML = "loading."; break;
							case 2: div.innerHTML = "loading.."; break;
							case 3: div.innerHTML = "loading..."; break;
						}
						setTimeout(loadingFunc, 333);
					}
				}
				loadingFunc();

				// データのロード
				var xhr = new XMLHttpRequest();
				xhr.open('GET', "<%=daturl %>");
				xhr.addEventListener("load", function(e){
					// データのロード完了
					window.jdat = JSON.parse(xhr.responseText);
					var js = window.jdat.load.js; delete window.jdat.load.js;
					var css = window.jdat.load.css; delete window.jdat.load.css;
					// スタイルシート設定
					var style = document.createElement("style");
					style.type = "text/css";
					document.head.appendChild(style);
					for(var i = 0; i < css.length; i++){
						style.sheet.insertRule(css[i], style.sheet.cssRules.length);
					}
					// ジャバスクリプト設定
					for(var i = 0; i < js.length; i++){
						var script = document.createElement("script");
						script.type = "text/javascript";
						script.innerHTML = js[i];
						document.head.appendChild(script);
					}
				});
				xhr.send();
			}
		</script>
	</head>
	<body>
		<div id="loading" style="position:absolute;width:100%;height:100%;z-index:9999;background-color:black;">
			<div id="loadingStr" style="color:white;margin:10px;">
			</div>
		</div>
	</body>
</html>

